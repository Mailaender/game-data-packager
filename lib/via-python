# vim:set ft=sh sw=4 sts=4 et:

# Data-driven game-data-packager code for Jedi Outcast, Jedi Academy,
# Return to Castle Wolfenstein; hopefully generalizable to others.
#
# Must define LONGNAME, deb first.

sum="sha256"

copyin () {
    install -d `dirname "$2"`
    install -m644 "$1" "$2"
}

gdp_data_driven () {
    if [ "$*" = "" ]; then
        set _ --help
        shift
    fi

    (
    export ETCDIR
    export DATADIR
    export OUTDIR
    export WORKDIR
    PYTHONPATH="$LIBDIR"
    export PYTHONPATH
    if [ -n "${DEBUG:-}" ]; then
        export DEBUG
    fi
    python3 -m game_data_packager "$@"
    exit $?
    )

    if [ "$?" != 0 ]; then
        exit $?
    fi

    # Special value to signal that gdp should just install every .deb
    # in $WORKDIR
    OUTFILE="*.deb"
}
